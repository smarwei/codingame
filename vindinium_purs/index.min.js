var PS={};(function(t){"use strict";t["Control.Applicative"]=t["Control.Applicative"]||{};var n=t["Control.Applicative"];var r=function(t,n){this.Apply0=t;this.pure=n};var a=function(t){return t.pure};n["Applicative"]=r;n["pure"]=a})(PS);(function(t){"use strict";t["Control.Apply"]=t["Control.Apply"]||{};var n=t["Control.Apply"];var r=function(t,n){this.Functor0=t;this.apply=n};n["Apply"]=r})(PS);(function(t){"use strict";t["Control.Bind"]=t["Control.Bind"]||{};var n=t["Control.Bind"];var r=function(t,n){this.Apply0=t;this.bind=n};var a=function(t){return t.bind};n["Bind"]=r;n["bind"]=a})(PS);(function(t){"use strict";t["Control.Semigroupoid"]=t["Control.Semigroupoid"]||{};var n=t["Control.Semigroupoid"];var r=function(t){this.compose=t};var a=new r(function(r){return function(n){return function(t){return r(n(t))}}});n["semigroupoidFn"]=a})(PS);(function(t){"use strict";t["Control.Category"]=t["Control.Category"]||{};var n=t["Control.Category"];var r=t["Control.Semigroupoid"];var a=function(t,n){this.Semigroupoid0=t;this.identity=n};var o=function(t){return t.identity};var e=new a(function(){return r.semigroupoidFn},function(t){return t});n["identity"]=o;n["categoryFn"]=e})(PS);(function(t){"use strict";t["Control.Monad"]=t["Control.Monad"]||{};var n=t["Control.Monad"];var a=t["Control.Applicative"];var o=t["Control.Bind"];var r=function(t,n){this.Applicative0=t;this.Bind1=n};var e=function(r){return function(n){return function(t){return o.bind(r.Bind1())(n)(function(n){return o.bind(r.Bind1())(t)(function(t){return a.pure(r.Applicative0())(n(t))})})}}};n["Monad"]=r;n["ap"]=e})(PS);(function(t){"use strict";t["Data.Functor"]=t["Data.Functor"]||{};var n=t["Data.Functor"];var r=function(t){this.map=t};var a=function(t){return t.map};n["Functor"]=r;n["map"]=a})(PS);(function(t){"use strict";t["Data.Newtype"]=t["Data.Newtype"]||{};var n=t["Data.Newtype"];var r=function(t,n){this.unwrap=t;this.wrap=n};var a=function(t){return t.unwrap};n["unwrap"]=a;n["Newtype"]=r})(PS);(function(t){"use strict";t["Data.Identity"]=t["Data.Identity"]||{};var n=t["Data.Identity"];var r=t["Control.Applicative"];var a=t["Control.Apply"];var o=t["Control.Bind"];var e=t["Control.Monad"];var u=t["Data.Functor"];var i=t["Data.Newtype"];var c=function(t){return t};var f=new i.Newtype(function(t){return t},c);var v=new u.Functor(function(n){return function(t){return n(t)}});var s=new a.Apply(function(){return v},function(n){return function(t){return n(t)}});var l=new o.Bind(function(){return s},function(n){return function(t){return t(n)}});var p=new r.Applicative(function(){return s},c);var d=new e.Monad(function(){return p},function(){return l});n["newtypeIdentity"]=f;n["monadIdentity"]=d})(PS);(function(t){"use strict";t["Control.Monad.State"]=t["Control.Monad.State"]||{};var n=t["Control.Monad.State"];var a=t["Data.Identity"];var o=t["Data.Newtype"];var r=function(n){var r=o.unwrap(a.newtypeIdentity);return function(t){return r(n(t))}};n["runState"]=r})(PS);(function(t){"use strict";t["Data.Tuple"]=t["Data.Tuple"]||{};var n=t["Data.Tuple"];var r=function(){function r(t,n){this.value0=t;this.value1=n}r.create=function(n){return function(t){return new r(n,t)}};return r}();var a=function(t){return t.value1};var o=function(t){return t.value0};n["Tuple"]=r;n["fst"]=o;n["snd"]=a})(PS);(function(t){"use strict";t["Control.Monad.State.Trans"]=t["Control.Monad.State.Trans"]||{};var n=t["Control.Monad.State.Trans"];var a=t["Control.Applicative"];var r=t["Control.Apply"];var o=t["Control.Bind"];var e=t["Control.Monad"];var u=t["Data.Functor"];var i=t["Data.Tuple"];var c=function(a){return new u.Functor(function(r){return function(n){return function(t){return u.map(a)(function(t){return new i.Tuple(r(t.value0),t.value1)})(n(t))}}})};var f=function(t){return new e.Monad(function(){return l(t)},function(){return v(t)})};var v=function(a){return new o.Bind(function(){return s(a)},function(n){return function(r){return function(t){return o.bind(a.Bind1())(n(t))(function(t){var n=r(t.value0);return n(t.value1)})}}})};var s=function(t){return new r.Apply(function(){return c(t.Bind1().Apply0().Functor0())},e.ap(f(t)))};var l=function(r){return new a.Applicative(function(){return s(r)},function(n){return function(t){return a.pure(r.Applicative0())(new i.Tuple(n,t))}})};n["applicativeStateT"]=l})(PS);(function(t){"use strict";t["Data.Boolean"]=t["Data.Boolean"]||{};var n=t["Data.Boolean"];var r=true;n["otherwise"]=r})(PS);(function(t){"use strict";t.topInt=2147483647;t.bottomInt=-2147483648})(PS["Data.Bounded"]=PS["Data.Bounded"]||{});(function(t){"use strict";var n=function(o){return function(a){return function(r){return function(n){return function(t){return n<t?o:n===t?a:r}}}}};t.ordIntImpl=n})(PS["Data.Ord"]=PS["Data.Ord"]||{});(function(t){"use strict";var n=function(n){return function(t){return n===t}};t.eqIntImpl=n})(PS["Data.Eq"]=PS["Data.Eq"]||{});(function(t){"use strict";t["Data.Eq"]=t["Data.Eq"]||{};var n=t["Data.Eq"];var r=t["Data.Eq"];var a=function(t){this.eq=t};var o=new a(r.eqIntImpl);n["eqInt"]=o})(PS);(function(t){"use strict";t["Data.Ordering"]=t["Data.Ordering"]||{};var n=t["Data.Ordering"];var r=function(){function t(){}t.value=new t;return t}();var a=function(){function t(){}t.value=new t;return t}();var o=function(){function t(){}t.value=new t;return t}();n["LT"]=r;n["GT"]=a;n["EQ"]=o})(PS);(function(t){"use strict";t["Data.Ord"]=t["Data.Ord"]||{};var n=t["Data.Ord"];var r=t["Data.Ord"];var a=t["Data.Eq"];var o=t["Data.Ordering"];var e=function(t,n){this.Eq0=t;this.compare=n};var u=new e(function(){return a.eqInt},r.ordIntImpl(o.LT.value)(o.EQ.value)(o.GT.value));n["ordInt"]=u})(PS);(function(t){"use strict";t["Data.Bounded"]=t["Data.Bounded"]||{};var n=t["Data.Bounded"];var r=t["Data.Bounded"];var a=t["Data.Ord"];var o=function(t,n,r){this.Ord0=t;this.bottom=n;this.top=r};var e=function(t){return t.top};var u=new o(function(){return a.ordInt},r.bottomInt,r.topInt);var i=function(t){return t.bottom};n["bottom"]=i;n["top"]=e;n["boundedInt"]=u})(PS);(function(t){"use strict";t.fromNumberImpl=function(r){return function(n){return function(t){return(t|0)===t?r(t):n}}};t.toNumber=function(t){return t}})(PS["Data.Int"]=PS["Data.Int"]||{});(function(t){"use strict";t["Data.Maybe"]=t["Data.Maybe"]||{};var n=t["Data.Maybe"];var r=t["Control.Category"];var a=function(){function t(){}t.value=new t;return t}();var o=function(){function n(t){this.value0=t}n.create=function(t){return new n(t)};return n}();var e=function(r){return function(n){return function(t){if(t instanceof a){return r}if(t instanceof o){return n(t.value0)}throw new Error("Failed pattern match at Data.Maybe (line 217, column 1 - line 217, column 51): "+[r.constructor.name,n.constructor.name,t.constructor.name])}}};var u=function(t){return e(t)(r.identity(r.categoryFn))};n["Nothing"]=a;n["Just"]=o;n["fromMaybe"]=u})(PS);(function(t){"use strict";t.infinity=Infinity})(PS["Global"]=PS["Global"]||{});(function(t){"use strict";t["Global"]=t["Global"]||{};var n=t["Global"];var r=t["Global"];n["infinity"]=r.infinity})(PS);(function(t){"use strict";t.floor=Math.floor})(PS["Math"]=PS["Math"]||{});(function(t){"use strict";t["Math"]=t["Math"]||{};var n=t["Math"];var r=t["Math"];n["floor"]=r.floor})(PS);(function(t){"use strict";t["Data.Int"]=t["Data.Int"]||{};var n=t["Data.Int"];var r=t["Data.Int"];var a=t["Data.Boolean"];var o=t["Data.Bounded"];var e=t["Data.Maybe"];var u=t["Global"];var i=t["Math"];var c=r.fromNumberImpl(e.Just.create)(e.Nothing.value);var f=function(t){if(t===u.infinity){return 0}if(t===-u.infinity){return 0}if(t>=r.toNumber(o.top(o.boundedInt))){return o.top(o.boundedInt)}if(t<=r.toNumber(o.bottom(o.boundedInt))){return o.bottom(o.boundedInt)}if(a.otherwise){return e.fromMaybe(0)(c(t))}throw new Error("Failed pattern match at Data.Int (line 66, column 1 - line 66, column 29): "+[t.constructor.name])};var v=function(t){return f(i.floor(t))};n["floor"]=v;n["toNumber"]=r.toNumber})(PS);(function(t){"use strict";t.showStringImpl=function(o){var e=o.length;return'"'+o.replace(/[\0-\x1F\x7F"\\]/g,function(t,n){switch(t){case'"':case"\\":return"\\"+t;case"":return"\\a";case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\v":return"\\v"}var r=n+1;var a=r<e&&o[r]>="0"&&o[r]<="9"?"\\&":"";return"\\"+t.charCodeAt(0).toString(10)+a})+'"'};t.showArrayImpl=function(o){return function(t){var n=[];for(var r=0,a=t.length;r<a;r++){n[r]=o(t[r])}return"["+n.join(",")+"]"}}})(PS["Data.Show"]=PS["Data.Show"]||{});(function(t){"use strict";t["Data.Show"]=t["Data.Show"]||{};var n=t["Data.Show"];var r=t["Data.Show"];var a=function(t){this.show=t};var o=new a(r.showStringImpl);var e=function(t){return t.show};var u=function(t){return new a(r.showArrayImpl(e(t)))};n["show"]=e;n["showString"]=o;n["showArray"]=u})(PS);(function(t){"use strict";t.log=function(t){return function(){console.log(t);return{}}};t.error=function(t){return function(){console.error(t);return{}}}})(PS["Effect.Console"]=PS["Effect.Console"]||{});(function(t){"use strict";t["Effect.Console"]=t["Effect.Console"]||{};var n=t["Effect.Console"];var r=t["Effect.Console"];n["log"]=r.log;n["error"]=r.error})(PS);(function(t){"use strict";t.random=Math.random})(PS["Effect.Random"]=PS["Effect.Random"]||{});(function(t){"use strict";t["Effect.Random"]=t["Effect.Random"]||{};var n=t["Effect.Random"];var e=t["Effect.Random"];var u=t["Data.Int"];var r=function(o){return function(a){return function t(){var n=e.random();var r=(u.toNumber(a)-u.toNumber(o)+1)*n+u.toNumber(o);return u.floor(r)}}};n["randomInt"]=r})(PS);(function(t){"use strict";t.parseInitInput=function(){var t=parseInt(readline());var n=[];for(var r=0;r<t;r++){var a=[];var o=readline();for(var e=0;e<o.length;e++){a.push(o[e])}n.push(a)}var u=parseInt(readline());return{boardSize:t,heroId:u,board:n}};t.parseInput=function(t){return function(){var t=parseInt(readline());var n=[];for(var r=0;r<t;r++){var a=readline().split(" ");var o=a[0];var e=parseInt(a[1]);var u=parseInt(a[2]);var i=parseInt(a[3]);var c=parseInt(a[4]);var f=parseInt(a[5]);n.push({entityType:o,id:e,x:u,y:i,life:c,gold:f})}return{entityCount:t,entities:n}}}})(PS["GameInput"]=PS["GameInput"]||{});(function(t){"use strict";t["GameInput"]=t["GameInput"]||{};var n=t["GameInput"];var r=t["GameInput"];n["parseInitInput"]=r.parseInitInput;n["parseInput"]=r.parseInput})(PS);(function(t){"use strict";t["Main"]=t["Main"]||{};var n=t["Main"];var r=t["Control.Applicative"];var c=t["Control.Monad.State"];var a=t["Control.Monad.State.Trans"];var o=t["Data.Boolean"];var e=t["Data.Identity"];var f=t["Data.Maybe"];var u=t["Data.Show"];var v=t["Data.Tuple"];var s=t["Effect.Console"];var l=t["Effect.Random"];var p=t["GameInput"];var d=function(t){if(t===0){return r.pure(a.applicativeStateT(e.monadIdentity))("NORTH")}if(t===1){return r.pure(a.applicativeStateT(e.monadIdentity))("EAST")}if(t===2){return r.pure(a.applicativeStateT(e.monadIdentity))("SOUTH")}if(o.otherwise){return r.pure(a.applicativeStateT(e.monadIdentity))("WEST")}throw new Error("Failed pattern match at Main (line 50, column 1 - line 50, column 38): "+[t.constructor.name])};var S=function(i){return function(t){return function t(){var n=p.parseInput();var r={boardSize:i.boardSize,heroId:i.heroId,board:i.board,entityCount:n.entityCount,entities:n.entities};var a=l.randomInt(0)(3)();var o=c.runState(d(a))(r);var e=v.snd(o);var u=v.fst(o);s.log(u)();return S(i)(new f.Just(e))()}}};var i=function t(){var n=p.parseInitInput();s.error(u.show(u.showArray(u.showArray(u.showString)))(n.board))();return S(n)(f.Nothing.value)()};n["main"]=i;n["nextRound"]=S;n["loop"]=d})(PS);PS["Main"].main();